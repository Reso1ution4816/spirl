
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SPIRL Fall 2021 Course – Week 4 (Oct 12) &#8212; Scientific Programming&lt;br&gt;In Real Life</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://cjtu.github.io/spirl/f21_a4.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1. The Bash Shell" href="bash_about.html" />
    <link rel="prev" title="Assignment 3 (Oct 05)" href="f21_a3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo_spirl.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Scientific Programming<br>In Real Life</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   Scientific Programming IRL
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  SPIRL Course
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="f21_about.html">
   Fall 2021
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="f21_assignments.html">
     How To Submit Assignments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="f21_a0.html">
     Assignment 0 (Sep 14)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="f21_a1.html">
     Assignment 1 (Sep 21)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="f21_a1_bonus.html">
     Assignment 1 (BONUS)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="f21_a2.html">
     Assignment 2 (Sep 28)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="f21_a3.html">
     Assignment 3 (Oct 05)
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     SPIRL Fall 2021 Course – Week 4 (Oct 12)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  SPIRL Textbook
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="bash_about.html">
   1. The Bash Shell
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="bash_shell.html">
     1.1. Meet the shell
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bash_basics.html">
     1.2. Bash Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bash_scripts.html">
     1.3. Scripts and Permissions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bash_tips.html">
     1.4. Extra tips and tricks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="git_about.html">
   2. Version control with Git
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="git_overview.html">
     2.1. Git overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="git_basics.html">
     2.2. Git basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="git_remotes.html">
     2.3. Remotes and GitHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="git_practice.html">
     2.4. Practicing Git IRL
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="python_about.html">
   3. Programming in Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="python_style.html">
     3.1. Python Style
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_basics.html">
     3.2. Python basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_basic-types.html">
     3.3. Basic Data Types (bool, int, float, str, list, tuple)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_methods.html">
     3.4. Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_functions.html">
     3.5. Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_conditionals.html">
     3.6. Conditionals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_loops.html">
     3.7. Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_adv-types.html">
     3.8. Advanced Data Types (set, dict)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_modules.html">
     3.9. Modules
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_str-formatting.html">
     3.10. String Formatting (Interactive)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="sp_about.html">
   4. Scientific Programming
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_jupyter.html">
     4.1. Jupyter Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_numpy.html">
     4.2. Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_matplotlib.html">
     4.3. Matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_scipy.html">
     4.4. Scipy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_pandas.html">
     4.5. Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sp_function-plotting.html">
     4.6. Function Plotting (Interactive)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="sandbox.html">
     4.7. Jupyter Sandbox
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="anaconda_about.html">
   5. Anaconda
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="anaconda_installing.html">
     5.1. Installing Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="anaconda_environments.html">
     5.2. Conda environments
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Practice coding here: <br><a href='https://cjtu.github.io/spirl/sandbox'>Jupyter Sandbox</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/f21_a4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cjtu/spirl"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cjtu/spirl/issues/new?title=Issue%20on%20page%20%2Ff21_a4.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cjtu/spirl/master?urlpath=tree/spirl/f21_a4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#readings-optional">
   Readings (optional)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#random-number-generators-rngs">
   Random Number Generators (RNGs)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pseudo-random-number-generators-prng">
     Pseudo-random number generators (PRNG)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy-random-module-np-random">
     NumPy Random Module (
     <code class="docutils literal notranslate">
      <span class="pre">
       np.random
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-histogram-with-plt-hist">
   Plot histogram with
   <code class="docutils literal notranslate">
    <span class="pre">
     plt.hist
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#short-quiz-find-the-bin-centers-from-edges-array">
     [Short Quiz] Find the bin centers from
     <code class="docutils literal notranslate">
      <span class="pre">
       edges
      </span>
     </code>
     array
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#side-note-list-comprehensions">
     [Side note:] List comprehensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#numpy-random-random-draws-from-a-distribution">
   NumPy Random - random draws from a distribution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#monte-carlo-uncertainty-error-propagation">
   Monte Carlo – Uncertainty (error) Propagation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#error-propagation-analytical">
     Error propagation (analytical)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#challenge-assignment">
   [Challenge assignment]
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#monte-carlo-bootstrapping">
   Monte Carlo – Bootstrapping
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignment-what-s-the-value-for-pi">
   [Assignment] What’s the value for
   <span class="math notranslate nohighlight">
    \(\pi\)
   </span>
   ?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="spirl-fall-2021-course-week-4-oct-12">
<h1>SPIRL Fall 2021 Course – Week 4 (Oct 12)<a class="headerlink" href="#spirl-fall-2021-course-week-4-oct-12" title="Permalink to this headline">¶</a></h1>
<p>Today we will talk about <strong>Monte Carlo (MC)</strong> methods, techniques that involve random sampling. But before we dive into that,
we will need to learn a little bit about random numbers in Python.</p>
<p>This will we will go over:</p>
<ol class="simple">
<li><p>Python Numpy Random Generator: <code class="docutils literal notranslate"><span class="pre">np.random.default_rng()</span></code></p></li>
<li><p>Plot histogram</p></li>
<li><p>Monte Carlo – Uncertainty Propagation</p></li>
<li><p>Monte Carlo – Bootstrapping</p></li>
</ol>
<div class="section" id="readings-optional">
<h2>Readings (optional)<a class="headerlink" href="#readings-optional" title="Permalink to this headline">¶</a></h2>
<p>If you find this week’s material new or challenging, you may want to read through some or all the following resources while working on your assignment:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://cjtu.github.io/spirl/python_conditionals.html#conditionals">SPIRL Ch. 3.6. Conditionals</a></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html">Numpy Random Generator</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="random-number-generators-rngs">
<h2>Random Number Generators (RNGs)<a class="headerlink" href="#random-number-generators-rngs" title="Permalink to this headline">¶</a></h2>
<p>To work with random numbers in Python, we can use the <code class="docutils literal notranslate"><span class="pre">random</span></code> module within <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="section" id="pseudo-random-number-generators-prng">
<h3>Pseudo-random number generators (PRNG)<a class="headerlink" href="#pseudo-random-number-generators-prng" title="Permalink to this headline">¶</a></h3>
<p>It might sound easy to come up with a random number, but many surveys have found this to not be the case (e.g. <a class="reference external" href="https://www.reddit.com/r/dataisbeautiful/comments/acow6y/asking_over_8500_students_to_pick_a_random_number/">Asking 8500 students to pick a random number</a>).</p>
<p>Because computers are deterministic (a collection of switches that can be “on” or “off”), it is surprisingly hard to produce a set of numbers that are truly random.  Luckily, we often don’t need a <em>truly</em> random set of numbers. Usually when we say we want random numbers, we want numbers that are:</p>
<ul class="simple">
<li><p>not biased to any particular value</p></li>
<li><p>contains no repeated or recognizable patterns</p></li>
</ul>
<p>This is where a <strong>pseudorandom number generator (PRNG)</strong> can help.</p>
<p>See what Wikipedia tell us about the PRNG:</p>
<blockquote>
<div><p>A pseudorandom number generator (PRNG), also known as a deterministic random bit generator (DRBG), is an algorithm for generating a sequence of numbers whose properties approximate the properties of sequences of random numbers. The PRNG-generated sequence is not truly random, because it is completely determined by an initial value, called the PRNG’s seed (which may include truly random values).</p>
</div></blockquote>
<p>The key “flaw” with a PRNG is that if you know a special value called the <strong>seed</strong>, you can regenerate the exact same sequence of random numbers again. But this ends up being as much a <em>feature</em> of a PRNG than as a <em>bug</em> which we’ll see later.</p>
<p>Since all computer generated random number generators are PRNGs, we often just drop the “P” and simply call them <strong>random number generators (RNGs)</strong> (but now you know their secret).</p>
<p>Read more about <a class="reference external" href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator">Pseudorandom number generators on Wikipedia</a>.</p>
</div>
<div class="section" id="numpy-random-module-np-random">
<h3>NumPy Random Module (<code class="docutils literal notranslate"><span class="pre">np.random</span></code>)<a class="headerlink" href="#numpy-random-module-np-random" title="Permalink to this headline">¶</a></h3>
<p>In NumPy, there are two ways to generate random numbers:</p>
<ul class="simple">
<li><p>Calling functions in <code class="docutils literal notranslate"><span class="pre">random</span></code> directly (<strong>deprecated</strong>): <code class="docutils literal notranslate"><span class="pre">np.random.func()</span></code></p></li>
<li><p>Generating an <code class="docutils literal notranslate"><span class="pre">rng</span></code> object with <code class="docutils literal notranslate"><span class="pre">obj</span> <span class="pre">=</span> <span class="pre">np.random.default_rng()</span></code> and calling methods on it: <code class="docutils literal notranslate"><span class="pre">obj.method()</span></code></p></li>
</ul>
<p>There are also different algorithms you can use to generate random numbers and if you mix and match RNG algorithms, you won’t be guaranteed the same random numbers even if you know the <strong>seed</strong>. This is why random numbers in different programming languages won’t necessarily be the same with the same seed (read more about <a class="reference external" href="https://numpy.org/doc/stable/reference/random/bit_generators/index.html">NumPy bit generators</a>). For almost all applications, the <code class="docutils literal notranslate"><span class="pre">default_random</span></code> from NumPy is sufficient (see <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#simple-random-data">NumPy simple random data</a>. Let’s try it out!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the random number generator object</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="c1"># help(rng.integers)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s first try to genertae random intergers with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>integers(low, high=None, size=None, dtype=np.int64, endpoint=False)

Return random integers from `low` (inclusive) to `high` (exclusive), or
if endpoint=True, `low` (inclusive) to `high` (inclusive). Replaces
`RandomState.randint` (with endpoint=False) and
`RandomState.random_integers` (with endpoint=True)

Return random integers from the &quot;discrete uniform&quot; distribution of
the specified dtype. If `high` is None (the default), then results are
from 0 to `low`.
...
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Draw random intergers from the range `draw_range` `ndraws` times.</span>
<span class="n">draw_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># (low, high)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># how many to generate or &quot;draw&quot;</span>

<span class="n">random_ints</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">*</span><span class="n">draw_range</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">random_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2 4 2 7 7 1 2 2]
</pre></div>
</div>
</div>
</div>
<p>Now use <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to run it many times to see if any is duplicated</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">random_ints</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">*</span><span class="n">draw_range</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Run </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: &#39;</span><span class="p">,</span> <span class="n">random_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Run 0:  [5 5 3 7 0 0 0 2]
Run 1:  [5 2 4 7 4 1 9 7]
Run 2:  [3 7 8 7 8 4 3 9]
Run 3:  [5 3 2 8 2 8 5 2]
Run 4:  [4 2 8 1 8 7 3 6]
Run 5:  [0 7 6 1 6 1 7 5]
Run 6:  [6 8 4 3 2 2 7 9]
Run 7:  [5 0 9 3 8 7 6 1]
Run 8:  [6 7 1 4 8 2 9 5]
Run 9:  [3 2 4 1 2 5 5 3]
</pre></div>
</div>
</div>
</div>
<p>But remember: these are <em>pseudo</em>random numbers, meaning we can generate the same random sequence again if we know the <strong>seed</strong> value.</p>
<p>This time, see what happens when we re-make the rng object with the same seed each time in the loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">draw_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">100</span>
 
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>  <span class="c1"># seed the default RNG</span>
    <span class="n">random_ints</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">*</span><span class="n">draw_range</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;run </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> give: &#39;</span><span class="p">,</span> <span class="n">random_ints</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>run 0 give:  [7 8 1 5 0 2 4 0 5 9]
run 1 give:  [7 8 1 5 0 2 4 0 5 9]
run 2 give:  [7 8 1 5 0 2 4 0 5 9]
run 3 give:  [7 8 1 5 0 2 4 0 5 9]
run 4 give:  [7 8 1 5 0 2 4 0 5 9]
run 5 give:  [7 8 1 5 0 2 4 0 5 9]
run 6 give:  [7 8 1 5 0 2 4 0 5 9]
run 7 give:  [7 8 1 5 0 2 4 0 5 9]
run 8 give:  [7 8 1 5 0 2 4 0 5 9]
run 9 give:  [7 8 1 5 0 2 4 0 5 9]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-histogram-with-plt-hist">
<h2>Plot histogram with <code class="docutils literal notranslate"><span class="pre">plt.hist</span></code><a class="headerlink" href="#plot-histogram-with-plt-hist" title="Permalink to this headline">¶</a></h2>
<p>We can verify how random our values are using a histogram.</p>
<p><code class="docutils literal notranslate"><span class="pre">help(plt.hist)</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>hist(x, bins=None, range=None, density=None, weights=None, cumulative=False, bottom=None, histtype=&#39;bar&#39;, align=&#39;mid&#39;, orientation=&#39;vertical&#39;, rwidth=None, log=False, color=None, label=None, stacked=False, normed=None, *, data=None, **kwargs)
    Plot a histogram.
...
    Returns
    -------
    n : array or list of arrays
        The values of the histogram bins. See *density* and *weights* for a
        description of the possible semantics.  If input *x* is an array,
        then this is an array of length *nbins*. If input is a sequence of
        arrays ``[data1, data2,..]``, then this is a list of arrays with
        the values of the histograms for each of the arrays in the same
        order.  The dtype of the array *n* (or of its element arrays) will
        always be float even if no weighting or normalization is used.
    
    bins : array
        The edges of the bins. Length nbins + 1 (nbins left edges and right
        edge of last bin).  Always a single array even when multiple data
        sets are passed in.
    
    patches : list or list of lists
        Silent list of individual patches used to create the histogram
        or list of such list if multiple input datasets.
...
</pre></div>
</div>
<p>We will also use a convenient helper function to take care of some of our plot formatting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If we want to apply the same format to each plot, we can make it a function!</span>
<span class="k">def</span> <span class="nf">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set formatting options on a matplotlib ax object.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The ax object to format.</span>
<span class="sd">    xlabel : str</span>
<span class="sd">        The x-axis label.</span>
<span class="sd">    ylabel : str</span>
<span class="sd">        The y-axis label.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span> <span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                     <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>   
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random number setup</span>
<span class="n">draw_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># Try doing different numbers of draws</span>

<span class="c1"># Do random draws</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>  
<span class="n">random_ints</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">*</span><span class="n">draw_range</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>

<span class="c1"># Set up plot and plot the histogram</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="c1"># Default hist</span>
<span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">random_ints</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>  <span class="c1"># Our helper function</span>


<span class="c1"># Center the bins and show as a &quot;step&quot; function</span>
<span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">random_ints</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                          <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>  <span class="c1"># Our helper function</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>findfont: Font family [&#39;Helvetica&#39;] not found. Falling back to DejaVu Sans.
</pre></div>
</div>
<img alt="_images/f21_a4_12_1.png" src="_images/f21_a4_12_1.png" />
</div>
</div>
<p>Let’s see what our histogram actually gave us in the <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">edges</span></code> it returned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number in each bins: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Edges of each bin: </span><span class="si">{</span><span class="n">edges</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number in each bins: [1037. 1027.  989. 1011.  983.  980. 1003.  967.  964. 1039.]
Edges of each bin: [-0.5  0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5  9.5]
</pre></div>
</div>
</div>
</div>
<p>Now, let’s overplot these data points back to the histogram.
But, before that, we need to find out the center values of the each bins.</p>
<div class="section" id="short-quiz-find-the-bin-centers-from-edges-array">
<h3>[Short Quiz] Find the bin centers from <code class="docutils literal notranslate"><span class="pre">edges</span></code> array<a class="headerlink" href="#short-quiz-find-the-bin-centers-from-edges-array" title="Permalink to this headline">¶</a></h3>
<p>Try to write code to covert bin edges to bin centers (copying the following list is cheating! We want to do it in general).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span>  <span class="mf">0.5</span>  <span class="mf">1.5</span>  <span class="mf">2.5</span>  <span class="mf">3.5</span>  <span class="mf">4.5</span>  <span class="mf">5.5</span>  <span class="mf">6.5</span>  <span class="mf">7.5</span>  <span class="mf">8.5</span>  <span class="mf">9.5</span><span class="p">]</span>
</pre></div>
</div>
<p>into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bin_center</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># put you code here, you have 5 mins</span>
<span class="n">edges</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.5,  0.5,  1.5,  2.5,  3.5,  4.5,  5.5,  6.5,  7.5,  8.5,  9.5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer 1 -- using the for loop</span>

<span class="n">bin_center</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">bin_center</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bin_center</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="side-note-list-comprehensions">
<h3>[Side note:] List comprehensions<a class="headerlink" href="#side-note-list-comprehensions" title="Permalink to this headline">¶</a></h3>
<p>List comprehensions are a fancy way to make a list using a simple 1 line <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>The basic syntax is square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> with the familiar <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">blah</span></code> inside.</p>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">i</span></code> at the beginning is just our loop variable and indicates what we want Python to be put in the final list. So we can also do math or functions on that loop variable, as we would in a for loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">squared</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="c1"># This is equivalent to:</span>
<span class="n">squared2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">squared2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">squared</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squared2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">squared</span> <span class="o">==</span> <span class="n">squared2</span><span class="p">)</span>  <span class="c1"># &quot;==&quot; tests for equality</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
True
</pre></div>
</div>
</div>
</div>
<p>Getting back to our problem of converting bin edges to bin centers, we can do this with a list comprehension!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer 2 -- using the list comprehension</span>

<span class="n">bin_center</span> <span class="o">=</span> <span class="p">[(</span><span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bin_center</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0]
</pre></div>
</div>
</div>
</div>
<p>Finally, we have a 3rd solution which takes advantage of NumPy array indexing, slicing, and element-wise math. We call this <strong>vectorization</strong> and it is usually the most efficient way to solve a problem. It also often uses less code which can be good, since less code has less room for errors.</p>
<p>Vectorizing code takes a little practice. The main idea is to think about arrays as collections of numbers we can do math on all at once.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer 3 -- array slicing (recommended)</span>

<span class="n">bin_center</span> <span class="o">=</span> <span class="p">(</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bin_center</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 1. 2. 3. 4. 5. 6. 7. 8. 9.]
</pre></div>
</div>
</div>
</div>
<p>Let’s break that example down to see what we did:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># All edges except the last one</span>
<span class="nb">print</span><span class="p">(</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>   <span class="c1"># All edges except the first one</span>

<span class="c1"># Now we have 2 arrays of elements but they are offset by 1</span>
<span class="c1"># Now we want to take the avg of these adjacent elements to get the centers</span>
<span class="nb">print</span><span class="p">((</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Mean is just (el1 + el2) / 2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-0.5  0.5  1.5  2.5  3.5  4.5  5.5  6.5  7.5  8.5]
[0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5]
[0. 1. 2. 3. 4. 5. 6. 7. 8. 9.]
</pre></div>
</div>
</div>
</div>
<p>Whichever way you figured out how to compute the centers, we can now plot the bin centers on our histogram!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random number setup</span>
<span class="n">draw_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>       <span class="c1"># this time put in the seed value    </span>
<span class="n">random_ints</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="o">*</span><span class="n">draw_range</span><span class="p">,</span> 
                            <span class="n">ndraws</span><span class="p">)</span>

<span class="c1"># plotting</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span> <span class="p">)</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot the histogram</span>
<span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">random_ints</span><span class="p">,</span> <span class="nb">range</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>

<span class="n">bin_center</span> <span class="o">=</span> <span class="p">(</span><span class="n">edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_center</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21_a4_29_0.png" src="_images/f21_a4_29_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="numpy-random-random-draws-from-a-distribution">
<h2>NumPy Random - random draws from a distribution<a class="headerlink" href="#numpy-random-random-draws-from-a-distribution" title="Permalink to this headline">¶</a></h2>
<p>We can draw from a variety of statistical distributions using our <code class="docutils literal notranslate"><span class="pre">numpy.random.default_rng</span></code> object (see all of them at <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generator.html#distributions">NumPy Random Distributions</a>.</p>
<p>We’ll see this in action with the normal (Gaussian) distribution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>normal(...) method of numpy.random._generator.Generator instance
    normal(loc=0.0, scale=1.0, size=None)
    
    Draw random samples from a normal (Gaussian) distribution.
    
    Parameters
    ----------
    loc : float or array_like of floats
        Mean (&quot;centre&quot;) of the distribution.
    scale : float or array_like of floats
        Standard deviation (spread or &quot;width&quot;) of the distribution. Must be
        non-negative.
    size : int or tuple of ints, optional
        Output shape.  If the given shape is, e.g., ``(m, n, k)``, then
        ``m * n * k`` samples are drawn.  If size is ``None`` (default),
        a single value is returned if ``loc`` and ``scale`` are both scalars.
        Otherwise, ``np.broadcast(loc, scale).size`` samples are drawn.
...
</pre></div>
</div>
<p>In the docstring for <code class="docutils literal notranslate"><span class="pre">rng.normal</span></code>, we can see it asks for a <code class="docutils literal notranslate"><span class="pre">loc</span></code> (mean) and <code class="docutils literal notranslate"><span class="pre">scale</span></code> (standard deviation) of the Gaussian distribution to randomly draw from.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random number setup</span>
<span class="n">draw_mean_std</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># (mean, stdev)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">draws</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">*</span><span class="n">draw_mean_std</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">draws</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 9.97565298 10.09256    10.2937732  10.29901997 10.37028591  9.78453144
  9.83783624  9.64644095 10.16691142 10.20341755]
</pre></div>
</div>
</div>
</div>
<p>Similarly to above, we can see that after many draws, our histogram begins to look like a typical Gaussian “bell curve” centered at the mean with standard deviation spread.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random number setup</span>
<span class="n">draw_mean_std</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># &lt;- try changing the number of draws</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">draws</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">*</span><span class="n">draw_mean_std</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>

<span class="c1"># plotting </span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">n</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">draws</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21_a4_33_0.png" src="_images/f21_a4_33_0.png" />
</div>
</div>
</div>
<div class="section" id="monte-carlo-uncertainty-error-propagation">
<h2>Monte Carlo – Uncertainty (error) Propagation<a class="headerlink" href="#monte-carlo-uncertainty-error-propagation" title="Permalink to this headline">¶</a></h2>
<p>Recall last week we had a simple measurement with some error associated with it.</p>
<p>What happens when we cannot measure a quantity and its error directly but still want to estimate the errors on it?</p>
<p>This is a job for <strong>error propagation</strong>!</p>
<div class="section" id="error-propagation-analytical">
<h3>Error propagation (analytical)<a class="headerlink" href="#error-propagation-analytical" title="Permalink to this headline">¶</a></h3>
<p>If you only feed your measurement data through simple functions, we can “propagate” that error with the following error propagation equations:</p>
<p><img alt="Uncertainty Propagation" src="http://science.clemson.edu/physics/labs/tutorials/errorp/eptable.gif" /></p>
<p>(from Clemson University)</p>
<p>This is the “analytical” way to propagate errors since we have well defined functions and can plug values in to compute the final errors.</p>
<p>For example, say we had a study where we measured a participant’s height and then the length of their hair. We want to find what their “total height” is if they were to pull their hair straight up.</p>
<p>You might imagine we used different tools to measure the person’s height (say a meter stick) and their hair length (say a ruler), and that those will have different precisions (error) associated with them. As good scientists, we want an accurate way to estimate the error of the “total height” so we’ll use the formula above.</p>
<ul class="simple">
<li><p>Meter stick precision: <span class="math notranslate nohighlight">\(1 cm = 0.01 m\)</span></p></li>
<li><p>Ruler precision: <span class="math notranslate nohighlight">\(5 mm = 0.005 m\)</span></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(H_{total} = Height + Hair\)</span></p>
<p>After our first measurement our average height and hair length is:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(Height = 1.7 \pm 0.01 m\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Hair Length = 0.27 \pm 0.005 m\)</span></p></li>
</ul>
<p>So we can get the total height simply as <span class="math notranslate nohighlight">\(H_{total} = 1.971 m\)</span></p>
<p>We can also get the uncertainty using the addition equation above:</p>
<p><span class="math notranslate nohighlight">\(\sigma_{H} = \sqrt{\sigma_{Height}^2 + \sigma_{Hair}^2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">height</span> <span class="o">=</span> <span class="mf">1.7</span>
<span class="n">height_err</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">hair_length</span> <span class="o">=</span> <span class="mf">0.27</span>
<span class="n">hair_err</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">htotal</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="n">hair_length</span>
<span class="n">h_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">height_err</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">hair_err</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;This person&#39;s total height was </span><span class="si">{</span><span class="n">htotal</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">h_err</span><span class="si">:</span><span class="s2">1.5f</span><span class="si">}</span><span class="s2"> m&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This person&#39;s total height was 1.97 +/- 0.01118 m
</pre></div>
</div>
</div>
</div>
<p>Then say we got the mean total height of 9 participants, we would have to use the “average” error propagation rule on our <code class="docutils literal notranslate"><span class="pre">h_err</span></code> to get the total uncertainty on our average. Below the <span class="math notranslate nohighlight">\(\bar{H}\)</span> indicates the average and N is the total number of measurements (participants).</p>
<p><span class="math notranslate nohighlight">\(\sigma_{\bar{H}} = \sqrt{\frac{\Sigma(H_i - \bar{H})^2}{N-1}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.93</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">,</span> <span class="mf">1.46</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mf">2.2</span> <span class="p">,</span> <span class="mf">1.95</span><span class="p">])</span>
<span class="n">hair_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">])</span>

<span class="n">h_totals</span> <span class="o">=</span> <span class="n">heights</span> <span class="o">+</span> <span class="n">hair_lengths</span>
<span class="n">h_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">height_err</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">hair_err</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># the same as before for each sum</span>

<span class="c1"># Take the mean total height</span>
<span class="n">h_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h_totals</span><span class="p">)</span>

<span class="c1"># Find average uncertainty</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>  <span class="c1"># Number of participants</span>
<span class="n">h_mean_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">h_mean</span><span class="o">-</span><span class="n">h_totals</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean total height (N=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">h_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">h_mean_err</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean total height (N=9): 2.02 +/- 0.329
</pre></div>
</div>
</div>
</div>
<p>Yay we got to report errors like good scientists! But we said this section was about randomness…</p>
<p>Let’s see another way to compute errors using only our measurements and our handy RNG object - no fancy error propagation formulas.</p>
<p>The idea here is that as long as our errors are normal (Gaussian), we can just feed random number drawn from a Gaussian through the same steps as our data analysis (in this example just a sum and a mean) and the resulting Gaussian will estimate our final errors!</p>
<p>We already know how to draw values from a Gaussian using our RNG so let’s try it!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start with the same data and add it, compute the mean as usual</span>
<span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.93</span><span class="p">,</span> <span class="mf">1.82</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">,</span> <span class="mf">1.46</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mf">2.2</span> <span class="p">,</span> <span class="mf">1.95</span><span class="p">])</span>
<span class="n">hair_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.56</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.1</span> <span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">])</span>
<span class="n">h_totals</span> <span class="o">=</span> <span class="n">heights</span> <span class="o">+</span> <span class="n">hair_lengths</span>

<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># &lt;- remove seed to see other random results</span>

<span class="c1"># Make our random arrays using the mean, standard dev of our measurements</span>
<span class="n">g_height</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heights</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">heights</span><span class="p">),</span> <span class="n">ndraws</span><span class="p">)</span>
<span class="n">g_hair</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hair_lengths</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">hair_lengths</span><span class="p">),</span> <span class="n">ndraws</span><span class="p">)</span>

<span class="c1"># Feed the gaussian samples through the sum</span>
<span class="n">g_total_arr</span> <span class="o">=</span> <span class="n">g_height</span> <span class="o">+</span> <span class="n">g_hair</span>

<span class="c1"># Because the error propagation formula for mean is just a standard deviation</span>
<span class="c1"># we can estimate the error of the mean with the stdev of our total array</span>
<span class="n">g_mean_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">g_total_arr</span><span class="p">)</span>

<span class="c1"># Now we report the same meanbut can use the gaussian standard dev as the err</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean total height (N=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">h_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">g_mean_err</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean total height (N=9): 2.02 +/- 0.277
</pre></div>
</div>
</div>
</div>
<p>The larger the ndraws you use, the more stable the g_mean_err will be.</p>
<p>We can try increasing the number of draws by hand to see when it levels out, but we have the power of code!</p>
<p>Let’s write up some code to see how many draws we need to get a stable g_mean_err.</p>
<p>We can define stable as <em>changes by less than</em> <span class="math notranslate nohighlight">\(10^{-3}\)</span> for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g_mean_err_old</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># &lt;- something big to start us off</span>
<span class="n">g_mean_err</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">delta_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">g_mean_err</span> <span class="o">-</span> <span class="n">g_mean_err_old</span><span class="p">)</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># &lt;- we&#39;ll multiply by a factor of 10 each time</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Stop loop when the difference drops below 1e-6</span>
<span class="k">while</span> <span class="n">delta_err</span> <span class="o">&gt;=</span> <span class="mf">1e-3</span><span class="p">:</span>
    <span class="n">g_height</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heights</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">heights</span><span class="p">),</span> <span class="n">ndraws</span><span class="p">)</span>
    <span class="n">g_hair</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hair_lengths</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">hair_lengths</span><span class="p">),</span> <span class="n">ndraws</span><span class="p">)</span>
    <span class="n">g_total_arr</span> <span class="o">=</span> <span class="n">g_height</span> <span class="o">+</span> <span class="n">g_hair</span>
    <span class="n">g_mean_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">g_total_arr</span><span class="p">)</span>

    <span class="n">delta_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">g_mean_err</span> <span class="o">-</span> <span class="n">g_mean_err_old</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">ndraws</span><span class="si">:</span><span class="s1">.0e</span><span class="si">}</span><span class="s1"> gives err </span><span class="si">{</span><span class="n">g_mean_err</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> with delta </span><span class="si">{</span><span class="n">delta_err</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">g_mean_err_old</span> <span class="o">=</span> <span class="n">g_mean_err</span>
    <span class="n">ndraws</span> <span class="o">*=</span> <span class="mi">10</span>  <span class="c1"># double our draws each time</span>
<span class="c1"># Now we can report our mean with confidence in our error precision</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean total height (N=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">h_mean</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">g_mean_err</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>N=1e+01 gives err 0.237 with delta inf
N=1e+02 gives err 0.260 with delta 2.29e-02
N=1e+03 gives err 0.309 with delta 4.83e-02
N=1e+04 gives err 0.308 with delta 3.94e-04
Mean total height (N=9): 2.02 +/- 0.308
</pre></div>
</div>
</div>
</div>
<p>Now we have an “empirical” estimate of our final error which didn’t need error propagation formulas!</p>
<p>Monte Carlo error propagation is particularly useful when you need to do a lot of manipulations to your data and don’t want to write out all the propagation formulas by hand. It is also useful when your analysis involves more complicated functions than just addition, subtraction, multiplication, division (e.g., exponentials, logarithms, other non-linear functions, etc).</p>
</div>
</div>
<div class="section" id="challenge-assignment">
<h2>[Challenge assignment]<a class="headerlink" href="#challenge-assignment" title="Permalink to this headline">¶</a></h2>
<p>But, what if you have something like
$<span class="math notranslate nohighlight">\(
\rho = \frac{m}{V} = \frac{m}{\pi r^2 (h/3)} = \frac{3m}{\pi r^2 h}
\)</span><span class="math notranslate nohighlight">\(
How fast can you get the error of the density (\)</span>\rho<span class="math notranslate nohighlight">\() propagated from errors of \)</span>m<span class="math notranslate nohighlight">\(, \)</span>r<span class="math notranslate nohighlight">\(, and \)</span>h$?</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="text-align:center head"><p>units</p></th>
<th class="text-align:center head"><p>values</p></th>
<th class="text-align:center head"><p>uncertainty (<span class="math notranslate nohighlight">\(\sigma\)</span>)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mass (m)</p></td>
<td class="text-align:center"><p>g</p></td>
<td class="text-align:center"><p>55.5</p></td>
<td class="text-align:center"><p>4.52</p></td>
</tr>
<tr class="row-odd"><td><p>Cone radius (r)</p></td>
<td class="text-align:center"><p>cm</p></td>
<td class="text-align:center"><p>14.2</p></td>
<td class="text-align:center"><p>1.11</p></td>
</tr>
<tr class="row-even"><td><p>Cone height (h)</p></td>
<td class="text-align:center"><p>cm</p></td>
<td class="text-align:center"><p>9.9</p></td>
<td class="text-align:center"><p>0.59</p></td>
</tr>
</tbody>
</table>
<p>modified from <a class="reference external" href="https://www.youtube.com/watch?v=V4U6RFI6HW8&amp;t=298s">Steve Spicklemire’s youtube video</a></p>
<ol class="simple">
<li><p>Find a better/faster way to reach a stable <span class="math notranslate nohighlight">\(\sigma_{\rho}\)</span> value</p></li>
<li><p>Use a more strict stable condition: <code class="docutils literal notranslate"><span class="pre">differ</span> <span class="pre">&lt;</span> <span class="pre">1e-6</span></code> must meet for 10 consecutive <code class="docutils literal notranslate"><span class="pre">ndraws</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [your code here]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="monte-carlo-bootstrapping">
<h2>Monte Carlo – Bootstrapping<a class="headerlink" href="#monte-carlo-bootstrapping" title="Permalink to this headline">¶</a></h2>
<p>We can also use Monte Carlo methods to “bootstrap” confidence intervals on our measured quantities. This is often useful when we have a small sample of measurements and don’t know the errors involved. Using the scatter inherent in our data and our handy random number generator, we can still get a statistical measure of errors as confidence intervals, pulling the data up by its bootstraps.</p>
<p><strong>Note:</strong> The main assumption with bootstrapping is that all measurements are <em>iid normal</em>, meaning each observation was collected independently of other measurements and is expected to have normal (Gaussian) errors.</p>
<p>Modified from <a class="reference external" href="https://bookdown.org/dereksonderegger/570/3-confidence-intervals-via-bootstrapping.html">Introduction to Statistical Methodology, Second Edition Chaper 3</a></p>
<p>Let’s read in an array of data that measures the mercury levels of several lakes in Florida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We&#39;ll do a deep dive on pandas soon! for now we&#39;re just using it to get data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://www.lock5stat.com/datasets3e/FloridaLakes.csv&#39;</span><span class="p">)</span>
<span class="n">avg_mercury</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AvgMercury&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;N measurements:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>N measurements: 53
</pre></div>
</div>
</div>
</div>
<p>Let’s make a histogram to see what we’re looking at!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a histogram </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Avg mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mercury level in Florida Lakes&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21_a4_48_0.png" src="_images/f21_a4_48_0.png" />
</div>
</div>
<p>Hmm this histogram doesn’t look very Gaussian… it seems a little skewed (not symmetrical).</p>
<p>When we have a skewed distribution, the mean of the value is not always the best measure of the center of the values. Also, what would the standard deviation be? So far we’ve only seen symmetrical scatter in our data…</p>
<p>We can still calculate them but they may not represent the data as nicely as the examples we’ve seen so far.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean mercury in Florida lakes is </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)</span><span class="si">:</span><span class="s1">1.2f</span><span class="si">}</span><span class="s1">, +/- </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean mercury in Florida lakes is 0.53, +/- 0.338
</pre></div>
</div>
</div>
</div>
<p>When we have small numbers of observations that are skewed, we can’t always be confident that the mean and standard deviation are good measures of the underlying distribution in our data. This is where <strong>bootstrapping</strong> becomes very useful!</p>
<p>This time we will use <code class="docutils literal notranslate"><span class="pre">rng.choice()</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>choice(a, size=None, replace=True, p=None, axis=0, shuffle=True)

Generates a random sample from a given array

Parameters
----------
a : {array_like, int}
    If an ndarray, a random sample is generated from its elements.
    If an int, the random sample is generated from np.arange(a).
size : {int, tuple[int]}, optional
    Output shape.  If the given shape is, e.g., ``(m, n, k)``, then
    ``m * n * k`` samples are drawn from the 1-d `a`. If `a` has more
    than one dimension, the `size` shape will be inserted into the
    `axis` dimension, so the output ``ndim`` will be ``a.ndim - 1 +
    len(size)``. Default is None, in which case a single value is
    returned.
replace : bool, optional
    Whether the sample is with or without replacement. Default is True,
    meaning that a value of ``a`` can be selected multiple times.
p : 1-D array_like, optional
    The probabilities associated with each entry in a.
    If not given, the sample assumes a uniform distribution over all
    entries in ``a``.
...
</pre></div>
</div>
<p>In <strong>bootstrapping</strong> we want to resample the same number of data points <strong>with replacement</strong>, meaning the same values can be drawn multiple times. This also means we need to set <code class="docutils literal notranslate"><span class="pre">replace=True</span></code> in our <code class="docutils literal notranslate"><span class="pre">choice()</span></code> method (but since this is the default we’re ok not specifying it).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="n">ndraws</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)</span>  <span class="c1"># Take same number of draws as in the measurement</span>
<span class="n">avg_mercury_resamp</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="n">ndraws</span><span class="p">)</span>  <span class="c1"># replace=True by default</span>
<span class="nb">print</span><span class="p">(</span><span class="n">avg_mercury_resamp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.34 0.65 0.86 0.65 0.27 0.43 0.16 0.71 0.86 0.16 0.48 0.5  0.86 0.77
 0.18 0.05 1.08 0.44 0.27 0.59 0.84 0.94 0.21 0.1  1.1  0.04 0.73 0.16
 0.05 0.87 0.34 0.5  0.81 0.04 1.16 1.23 0.19 0.05 0.4  0.27 0.27 0.34
 0.5  0.77 0.25 1.33 0.5  0.27 1.1  0.5  1.33 0.27 0.04]
</pre></div>
</div>
</div>
</div>
<p>Below we’ll plot the original mean as a vertical black line and the mean of the resampled array as a vertical red line using <code class="docutils literal notranslate"><span class="pre">ax.axvline()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up plot </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span> <span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Avg mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mercury level in Florida Lakes&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>

<span class="c1"># Plot original and mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Plot resampled histogram and mean</span>
<span class="n">avg_mercury_resamp</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">avg_mercury_resamp</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury_resamp</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f4b633d8a00&gt;
</pre></div>
</div>
<img alt="_images/f21_a4_54_1.png" src="_images/f21_a4_54_1.png" />
</div>
</div>
<p>It might be surprising that the mean has changed! All we did was resample from the original data and take the mean. If we do this many time, we’ll get a distribution of means which we can think of as a set of possible outcomes if we had taken the measurements again and again.</p>
<p>Because we are reusing the same measurements to resample, this won’t make our mean any more accurate (because we have no new data to go off of).</p>
<p>What this <em>does</em> do is show us how much our mean would vary if we repeated our experiment many times with the same number of observations and similar scatter in the data… It’s a new way to <strong>bootstrap</strong> uncertainty when we didn’t have any info about the error arrays to do error propagation!</p>
<p>Below, let’s rum our resampling a bunch of times and see what values we get for the mean…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Avg mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mercury level in Florida Lakes&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># random draw result</span>
<span class="n">sample_times</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="n">mean_collection</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sample_times</span><span class="p">):</span> 
        <span class="n">avg_mercury_resamp</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">))</span>
        <span class="n">mean_collection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury_resamp</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mean_collection</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21_a4_56_0.png" src="_images/f21_a4_56_0.png" />
</div>
</div>
<p>This looks like a normal (Gaussian) distribution, so we can talk about the dispersion of the mean in terms of the standard deviation!</p>
<p>Now we can report the uncertainty of the mean on our original plot in a more satisfying way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up plot </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span> <span class="p">)</span>
<span class="n">set_plot_axis_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;Avg mercury&#39;</span><span class="p">,</span> <span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mercury level in Florida Lakes&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">)</span>

<span class="c1"># Plot original and mean</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">)),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_mercury</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the 95% confidence interval [2.5%, 97.5%]</span>
<span class="n">pct95_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mean_collection</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">pct95_upp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mean_collection</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pct95_low</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95th pct&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">pct95_upp</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean mercury in Florida lakes is </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s1">1.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; with a 95% confidence interval of [</span><span class="si">{</span><span class="n">pct95_low</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">pct95_upp</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean mercury in Florida lakes is 0.53 with a 95% confidence interval of [0.44, 0.62]
</pre></div>
</div>
<img alt="_images/f21_a4_58_1.png" src="_images/f21_a4_58_1.png" />
</div>
</div>
<p>Now using the distribution of the bootstrapped means, we can capture the scatter in our data with N=59 observations if we were to repeat the trial many times.</p>
<p>Now we can say we are 95% confident that the true mean mercury in Florida lakes is within our 95% confidence interval, given the measurements we made.</p>
</div>
<div class="section" id="assignment-what-s-the-value-for-pi">
<h2>[Assignment] What’s the value for <span class="math notranslate nohighlight">\(\pi\)</span>?<a class="headerlink" href="#assignment-what-s-the-value-for-pi" title="Permalink to this headline">¶</a></h2>
<p>In this assignment, you will need to use the MC method to estimate the values of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Assuming you have a quarter circle with the radius of 1 and a square that share it’s edge with the quarter circle’s
radius (see the plot below).</p>
<p><img alt="Monte-Carlo pi" src="https://helloacm.com/wp-content/uploads/2015/11/Monte-Carlo01.jpg" /></p>
<p>Therefore, we know:
$<span class="math notranslate nohighlight">\(
Area_{\rm quarter\ circle} = \pi r^2/4 \\
Area_{\rm square} = r^2
\)</span><span class="math notranslate nohighlight">\(
The ratio of the two will be
\)</span><span class="math notranslate nohighlight">\(
\frac{Area_{\rm quarter\ circle}}{Area_{\rm square}} = \frac{\pi r^2/4}{r^2} = \frac{\pi}{4}
\)</span><span class="math notranslate nohighlight">\(
Rearange the equation and changes the area with the number of points we have:
\)</span><span class="math notranslate nohighlight">\(
\pi = 4 \frac{Area_{\rm quarter\ circle}}{Area_{\rm square}} = 4 \frac{N_{\rm quarter\ circle}}{N_{\rm square}}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>N_{\rm quarter\ circle}<span class="math notranslate nohighlight">\( is the number of points within the quarter circle and \)</span>N_{\rm square}$ is the number of points
within the square.</p>
<p>Tips:</p>
<ol class="simple">
<li><p>You will need to generate two arrays with the random generator as the x and y axis of each points.</p></li>
<li><p>Calculate the number of points within the quarter circle and within the square</p></li>
<li><p>You get <span class="math notranslate nohighlight">\(\pi\)</span> by dividing the two numbers and times 4</p></li>
</ol>
<p><strong>Show that your <span class="math notranslate nohighlight">\(\pi\)</span> has <span class="math notranslate nohighlight">\(&lt; 1e-15\)</span> difference from <code class="docutils literal notranslate"><span class="pre">np.pi</span></code></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [your code here]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="f21_a3.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Assignment 3 (Oct 05)</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="bash_about.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title"><span class="section-number">1. </span>The Bash Shell</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Christian J. Tai Udovicic <a href="https://github.com/cjtu/spirl/graphs/contributors">et. al</a><br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            <a href='https://cjtu.github.io'>About Christian</a> <a href='https://jupyterbook.org/'>About this JupyterBook</a>
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-111642150-3', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  </body>
</html>